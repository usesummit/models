

"customer_query": =Object({"query": "email:'paul@example.com'<email>"})
"customer_search": =Request('get', "https://rk_live_yourstripekeyhere:@api.stripe.com/v1/customers/search")
"parse_customer_search": =Parser('$.data[0].id')
"charges_query": =Object({"query": "customer:'{{ parse_customer_search }}'"})
"charges_search": =Request('get', "https://rk_live_yourstripekeyhere:@api.stripe.com/v1/charges/search")
"summary_data": =Text("""The data to summarize: {% for charge in charges_search.data %} Created: {{ charge.created }} Amount: ${{ charge.amount | divided_by: 100 }} {% endfor %} """)
"output": =Object({"prompt": [{"role": "system", "content": "You are a business analyst for a SaaS reviewing accounts.  This customer account needs to be concisely summarized for our customer success team.  An example of a great summary: {% for line in prompt_example.first %} -- {{ line }} -- {% endfor %}"}, {"role": "user", "content": "{{ summary_data }}"}]})
"gpt_response": =Gpt("gpt-4", "sk-youropenaikeyhere")
"account_note": =Text("""{{ gpt_response }}""")
"response": =Response("account_note")



"example_sheet": =Table("https://docs.google.com/spreadsheets/d/e/2PACX-1vQpTQwjPoba67riG6R1zziPA3fi7K668NqYR7qyDhDTXHpfgZ-evYzGteFNKu-qBeuTYV23F1UvB27E/pub?gid=0&single=true&output=csv")
"prompt_example": =Query("SELECT * FROM $table")
